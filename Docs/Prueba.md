| TableID                                                                                                                                                                                        | Column Name                | Expression                                                                                                                                                                                                                                                                                                          |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 12                                                                                                                                                                                             | Duración (SEG)             | DATEDIFF('1. Producción (OT)'[FechaHora Ini], '1. Producción (OT)'[FechaHora Fin], SECOND)                                                                                                                                                                                                                          |
| 12                                                                                                                                                                                             | Duración (MIN)             | '1. Producción (OT)'[Duración (SEG)]/60                                                                                                                                                                                                                                                                             |
| 12                                                                                                                                                                                             | Duración (HR)              | '1. Producción (OT)'[Duración (MIN)]/60                                                                                                                                                                                                                                                                             |
| 12                                                                                                                                                                                             | Tiempo STD Producción (HR) | DIVIDE('1. Producción (OT)'[T. Ciclo]*'1. Producción (OT)'[Producción UN],3600)                                                                                                                                                                                                                                     |
| 12                                                                                                                                                                                             | ACTIVAR OT                 | IF(<br>    '1. Producción (OT)'[OT]=""OT0000000"" || '1. Producción (OT)'[Horas Paros] < 0 || '1. Producción (OT)'[INCREMENTO_SELECCION] > 200 || '1. Producción (OT)'[Duración (HR)] > 100 || '1. Producción (OT)'[FechaHora Fin] = 0 || '1. Producción (OT)'[Producción UN] < 0,<br>    0,<br>    1<br>)<br>      |
| 12                                                                                                                                                                                             | Horas Paros                | VAR RESULT = CALCULATE(<br>    SUM('1. Paros (OT)'[DURACION (HR)]),<br>    FILTER(<br>        '1. Paros (OT)',<br>        '1. Paros (OT)'[SECUENCIA] = '1. Producción (OT)'[Secuencia] -- Relaciona las tablas por el campo SECUENCIA<br>    )<br>)<br>VAR RESULTADO = IF(RESULT < 0,0,RESULT)<br>RETURN RESULTADO" |
| 12                                                                                                                                                                                             | Validación Paros           |                                                                                                                                                                                                                                                                                                                     |
| IF(                                                                                                                                                                                            |                            |                                                                                                                                                                                                                                                                                                                     |
|     OR(                                                                                                                                                                                        |                            |                                                                                                                                                                                                                                                                                                                     |
|         '1. Producción (OT)'[Horas Paros] >= '1. Producción (OT)'[Duración (HR)],                                                                                                              |                            |                                                                                                                                                                                                                                                                                                                     |
|         '1. Producción (OT)'[SECUENCIA] IN {""600632"", ""600642"", ""600641"",""600647""} -- Verifica si el valor de SECUENCIA está en la lista                                               |                            |                                                                                                                                                                                                                                                                                                                     |
|     ),                                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     0, -- Si Horas Paros es mayor o igual que Producción, o si SECUENCIA está en la lista                                                                                                      |                            |                                                                                                                                                                                                                                                                                                                     |
|     1  -- Si Horas Paros es menor que Producción y SECUENCIA no está en la lista                                                                                                               |                            |                                                                                                                                                                                                                                                                                                                     |
| )                                                                                                                                                                                              |                            |                                                                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
| 12                                                                                                                                                                                             | Tiempo Neto                | '1. Producción (OT)'[Duración (SEG)]-'1. Producción (OT)'[Segundos Paros]<br>                                                                                                                                                                                                                                       |
| 12                                                                                                                                                                                             | STD Piezas                 |                                                                                                                                                                                                                                                                                                                     |
| VAR TiempoNeto = '1. Producción (OT)'[Tiempo Neto]                                                                                                                                             |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR TCiclo = '1. Producción (OT)'[T. Ciclo]                                                                                                                                                    |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR Incremento = '1. Producción (OT)'[Incremento]                                                                                                                                              |                            |                                                                                                                                                                                                                                                                                                                     |
| -- Verificar si la máquina es del área de inyección                                                                                                                                            |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR EsInyeccion =                                                                                                                                                                              |                            |                                                                                                                                                                                                                                                                                                                     |
|     LOOKUPVALUE(                                                                                                                                                                               |                            |                                                                                                                                                                                                                                                                                                                     |
|         '0. Catalogo Lineas Final'[Area],                                                                                                                                                      |                            |                                                                                                                                                                                                                                                                                                                     |
|        '0. Catalogo Lineas Final'[Equipo], '1. Producción (OT)'[Equipo],                                                                                                                       |                            |                                                                                                                                                                                                                                                                                                                     |
|         BLANK()                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
|     ) = ""INYECCION""                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| -- Cálculo condicional                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
| RETURN                                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     IF(                                                                                                                                                                                        |                            |                                                                                                                                                                                                                                                                                                                     |
|         EsInyeccion,                                                                                                                                                                           |                            |                                                                                                                                                                                                                                                                                                                     |
|         DIVIDE(TiempoNeto, TCiclo) * Incremento,                                                                                                                                               |                            |                                                                                                                                                                                                                                                                                                                     |
|         DIVIDE(TiempoNeto, TCiclo)                                                                                                                                                             |                            |                                                                                                                                                                                                                                                                                                                     |
|     )                                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
| 12                                                                                                                                                                                             | Segundos Paros             | '1. Producción (OT)'[Horas Paros]*3600                                                                                                                                                                                                                                                                              |
| 12                                                                                                                                                                                             | VALIDACION_FECHA_FIN       |                                                                                                                                                                                                                                                                                                                     |
| VAR HoraInicio = HOUR('1. Producción (OT)'[FechaHora Ini]) + (MINUTE('1. Producción (OT)'[FechaHora Ini]) / 60) -- Convierte la hora de INICIO en formato decimal                              |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR HoraFin = HOUR('1. Producción (OT)'[FechaHora Fin]) + (MINUTE('1. Producción (OT)'[FechaHora Fin]) / 60) -- Convierte la hora de FIN en formato decimal                                    |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR Turno = '1. Producción (OT)'[IDTURNO ACT] -- Obtiene el turno actual                                                                                                                       |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR EsValido =                                                                                                                                                                                 |                            |                                                                                                                                                                                                                                                                                                                     |
|     SWITCH(                                                                                                                                                                                    |                            |                                                                                                                                                                                                                                                                                                                     |
|         TRUE(),                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
|         Turno = ""1"" && HoraFin >= 6 && HoraFin <= 14, 1, -- Turno Día: Inicio >= 6:00 AM y Fin <= 2:00 PM (14:00)                                                                            |                            |                                                                                                                                                                                                                                                                                                                     |
|         Turno = ""2"" && HoraFin >= 14 && HoraFin <= 21.5, 1, -- Turno Tarde: Inicio >= 2:00 PM y Fin <= 9:30 PM (21.5)                                                                        |                            |                                                                                                                                                                                                                                                                                                                     |
|         Turno = ""3"" && (                                                                                                                                                                     |                            |                                                                                                                                                                                                                                                                                                                     |
|             -- Para turno Noche, se valida que la hora de fin esté entre 9:30 PM y 6:00 AM (cruce de AM a PM)                                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
|             (HoraFin >= 21.5 && HoraFin <= 24) || (HoraFin >= 0 && HoraFin <= 6)                                                                                                               |                            |                                                                                                                                                                                                                                                                                                                     |
|         ), 1, -- Turno Noche: Inicio >= 9:30 PM y Fin entre 12:00 AM y 6:00 AM                                                                                                                 |                            |                                                                                                                                                                                                                                                                                                                     |
|         0 -- Si ninguna condición se cumple, marca como 0 (inválido)                                                                                                                           |                            |                                                                                                                                                                                                                                                                                                                     |
|     )                                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| RETURN                                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     EsValido                                                                                                                                                                                   |                            |                                                                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
| 12                                                                                                                                                                                             | DDuración (SEG)            |                                                                                                                                                                                                                                                                                                                     |
| VAR HoraInicio = '1. Producción (OT)'[FechaHora Ini]                                                                                                                                           |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR HoraFinOriginal = '1. Producción (OT)'[FechaHora Fin]                                                                                                                                      |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR Turno = '1. Producción (OT)'[IDTURNO ACT]                                                                                                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR Validacion = '1. Producción (OT)'[VALIDACION_FECHA_FIN]                                                                                                                                    |                            |                                                                                                                                                                                                                                                                                                                     |
| -- Determinar el límite de hora del turno                                                                                                                                                      |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR LimiteHoraFin =                                                                                                                                                                            |                            |                                                                                                                                                                                                                                                                                                                     |
|     SWITCH(                                                                                                                                                                                    |                            |                                                                                                                                                                                                                                                                                                                     |
|         TRUE(),                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
|         Turno = ""1"", DATE(YEAR(HoraInicio), MONTH(HoraInicio), DAY(HoraInicio)) + TIME(14, 0, 0), -- Turno Día: 2:00 PM                                                                      |                            |                                                                                                                                                                                                                                                                                                                     |
|         Turno = ""2"", DATE(YEAR(HoraInicio), MONTH(HoraInicio), DAY(HoraInicio)) + TIME(21, 30, 0), -- Turno Tarde: 9:30 PM                                                                   |                            |                                                                                                                                                                                                                                                                                                                     |
|         Turno = ""3"", DATE(YEAR(HoraInicio), MONTH(HoraInicio), DAY(HoraInicio) + (IF(HoraInicio > TIME(6, 0, 0), 0, 1))) + TIME(6, 0, 0) -- Turno Noche: 6:00 AM, considerando cambio de día |                            |                                                                                                                                                                                                                                                                                                                     |
|     )                                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| -- Ajustar la hora de fin si VALIDACION_FECHA_FIN es 0                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR HoraFinAjustada =                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
|     IF(                                                                                                                                                                                        |                            |                                                                                                                                                                                                                                                                                                                     |
|         Validacion = 0,                                                                                                                                                                        |                            |                                                                                                                                                                                                                                                                                                                     |
|         MIN(LimiteHoraFin, HoraFinOriginal), -- Usar la menor entre el límite del turno y la hora fin original                                                                                 |                            |                                                                                                                                                                                                                                                                                                                     |
|         HoraFinOriginal -- Usar la hora fin original si la validación es 1                                                                                                                     |                            |                                                                                                                                                                                                                                                                                                                     |
|     )                                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| -- Ajustar la hora de fin en caso de cruce de día                                                                                                                                              |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR HoraFinFinal =                                                                                                                                                                             |                            |                                                                                                                                                                                                                                                                                                                     |
|     IF(                                                                                                                                                                                        |                            |                                                                                                                                                                                                                                                                                                                     |
|         HoraFinAjustada < HoraInicio,                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
|         HoraFinAjustada + 1,  -- Si HoraFin es antes de HoraInicio, sumar un día completo (24 horas)                                                                                           |                            |                                                                                                                                                                                                                                                                                                                     |
|         HoraFinAjustada       -- Si no, usar la hora ajustada                                                                                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
|     )                                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| -- Calcular la diferencia en segundos                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR DuracionSegundos =                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     DATEDIFF(HoraInicio, HoraFinFinal, SECOND) -- Diferencia en segundos, siempre positiva                                                                                                     |                            |                                                                                                                                                                                                                                                                                                                     |
| RETURN                                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     DuracionSegundos"                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| 12                                                                                                                                                                                             | Horas Programado           |                                                                                                                                                                                                                                                                                                                     |
| CALCULATE(                                                                                                                                                                                     |                            |                                                                                                                                                                                                                                                                                                                     |
|     SUM('1. Paros (OT)'[PARO PROGRAMADO]),                                                                                                                                                     |                            |                                                                                                                                                                                                                                                                                                                     |
|     FILTER(                                                                                                                                                                                    |                            |                                                                                                                                                                                                                                                                                                                     |
|         '1. Paros (OT)',                                                                                                                                                                       |                            |                                                                                                                                                                                                                                                                                                                     |
|         '1. Paros (OT)'[SECUENCIA] = '1. Producción (OT)'[Secuencia] && -- Relaciona las tablas por el campo SECUENCIA                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|         '1. Paros (OT)'[PARO] <> ""SIN OT SIN PERSONAL"" -- Excluye los paros no deseados                                                                                                      |                            |                                                                                                                                                                                                                                                                                                                     |
|     )                                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| )"                                                                                                                                                                                             |                            |                                                                                                                                                                                                                                                                                                                     |
| 12                                                                                                                                                                                             | Horas No Programado        |                                                                                                                                                                                                                                                                                                                     |
| CALCULATE(                                                                                                                                                                                     |                            |                                                                                                                                                                                                                                                                                                                     |
|     SUM('1. Paros (OT)'[PARO NO PROGRAMADO]),                                                                                                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
|     FILTER(                                                                                                                                                                                    |                            |                                                                                                                                                                                                                                                                                                                     |
|         '1. Paros (OT)',                                                                                                                                                                       |                            |                                                                                                                                                                                                                                                                                                                     |
|         '1. Paros (OT)'[SECUENCIA] = '1. Producción (OT)'[Secuencia] && -- Relaciona las tablas por el campo SECUENCIA                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|         NOT('1. Paros (OT)'[PARO] IN {""FALTA OT"", ""FALTA PERSONAL""}) -- Excluye los paros no deseados                                                                                      |                            |                                                                                                                                                                                                                                                                                                                     |
|     )                                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| )                                                                                                                                                                                              |                            |                                                                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
| 12                                                                                                                                                                                             | Piezas Defectos            |                                                                                                                                                                                                                                                                                                                     |
| CALCULATE(                                                                                                                                                                                     |                            |                                                                                                                                                                                                                                                                                                                     |
|     SUM('1. Defectos (OT)'[PIEZAS]),                                                                                                                                                           |                            |                                                                                                                                                                                                                                                                                                                     |
|     FILTER(                                                                                                                                                                                    |                            |                                                                                                                                                                                                                                                                                                                     |
|         '1. Defectos (OT)',                                                                                                                                                                    |                            |                                                                                                                                                                                                                                                                                                                     |
|         '1. Defectos (OT)'[SECUENCIA] = '1. Producción (OT)'[Secuencia]                                                                                                                        |                            |                                                                                                                                                                                                                                                                                                                     |
|     )                                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| )                                                                                                                                                                                              |                            |                                                                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
| 12                                                                                                                                                                                             | Validación Defectos        | IF('1. Producción (OT)'[Piezas Defectos]>'1. Producción (OT)'[Producción UN],0,1)                                                                                                                                                                                                                                   |
| 150                                                                                                                                                                                            | DURACION (HR)              |                                                                                                                                                                                                                                                                                                                     |
| VAR FORMULA = DIVIDE('1. Paros (OT)'[DDuración (SEG)],3600)                                                                                                                                    |                            |                                                                                                                                                                                                                                                                                                                     |
| RETURN FORMULA"                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
| 150                                                                                                                                                                                            | PARO PROGRAMADO            |                                                                                                                                                                                                                                                                                                                     |
| SWITCH(                                                                                                                                                                                        |                            |                                                                                                                                                                                                                                                                                                                     |
|     TRUE(),                                                                                                                                                                                    |                            |                                                                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
|     // **NO PRODUCIDO / FALTA OT**: Si la duración es mayor a 5 horas y el área NO es ""INYECCION"", devuelve la duración                                                                      |                            |                                                                                                                                                                                                                                                                                                                     |
|     ('1. Paros (OT)'[PARO] IN {""NO PRODUCIDO"", ""FALTA OT""}) && '1. Paros (OT)'[DURACION (HR)] > 5 && '1. Paros (OT)'[AREA] <> ""INYECCION"",                                               |                            |                                                                                                                                                                                                                                                                                                                     |
|     '1. Paros (OT)'[DURACION (HR)],                                                                                                                                                            |                            |                                                                                                                                                                                                                                                                                                                     |
|     // Si el tipo de paro es ""NO PROGRAMADO"", devuelve 0                                                                                                                                     |                            |                                                                                                                                                                                                                                                                                                                     |
|     '1. Paros (OT)'[TIPO_PARO] = ""NO PROGRAMADO"",                                                                                                                                            |                            |                                                                                                                                                                                                                                                                                                                     |
|     0,                                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     // **COMIDA**: Si la duración es mayor a 0.5, asigna solo 0.5                                                                                                                              |                            |                                                                                                                                                                                                                                                                                                                     |
|     '1. Paros (OT)'[PARO] = ""COMIDA"" && '1. Paros (OT)'[DURACION (HR)] > 0.5,                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
|     0.5,                                                                                                                                                                                       |                            |                                                                                                                                                                                                                                                                                                                     |
|     // **BREAK**: Si la duración es mayor a 0.17, asigna solo 0.17                                                                                                                             |                            |                                                                                                                                                                                                                                                                                                                     |
|     '1. Paros (OT)'[PARO] = ""BREAK"" && '1. Paros (OT)'[DURACION (HR)] > 0.17,                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
|     0.17,                                                                                                                                                                                      |                            |                                                                                                                                                                                                                                                                                                                     |
|     // **EAD**: Si la duración es mayor a 1, asigna solo 1                                                                                                                                     |                            |                                                                                                                                                                                                                                                                                                                     |
|     '1. Paros (OT)'[PARO] = ""EAD"" && '1. Paros (OT)'[DURACION (HR)] > 1,                                                                                                                     |                            |                                                                                                                                                                                                                                                                                                                     |
|     1,                                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     // **CAMBIO DE MOLDES**: Si la duración es mayor a 40, asigna solo 40                                                                                                                      |                            |                                                                                                                                                                                                                                                                                                                     |
|     OR(                                                                                                                                                                                        |                            |                                                                                                                                                                                                                                                                                                                     |
|         '1. Paros (OT)'[PARO] = ""CAMBIO DE MOLDES"",                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
|         '1. Paros (OT)'[PARO] = ""CAMBIO MOLDE""                                                                                                                                               |                            |                                                                                                                                                                                                                                                                                                                     |
|     ) && '1. Paros (OT)'[DURACION (HR)] > 40,                                                                                                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
|     40,                                                                                                                                                                                        |                            |                                                                                                                                                                                                                                                                                                                     |
|     // **5'S FIN DE TURNO / FRECUENCIA**: Si la duración es mayor a 5, asigna solo 5                                                                                                           |                            |                                                                                                                                                                                                                                                                                                                     |
|     OR(                                                                                                                                                                                        |                            |                                                                                                                                                                                                                                                                                                                     |
|         '1. Paros (OT)'[PARO] = ""5´S FIN DE TURNO"",                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
|         '1. Paros (OT)'[PARO] = ""FRECUENCIA""                                                                                                                                                 |                            |                                                                                                                                                                                                                                                                                                                     |
|     ) && '1. Paros (OT)'[DURACION (HR)] > 5,                                                                                                                                                   |                            |                                                                                                                                                                                                                                                                                                                     |
|     5,                                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     // Si no se cumple ninguna condición, devuelve la duración original                                                                                                                        |                            |                                                                                                                                                                                                                                                                                                                     |
|     '1. Paros (OT)'[DURACION (HR)]                                                                                                                                                             |                            |                                                                                                                                                                                                                                                                                                                     |
| )                                                                                                                                                                                              |                            |                                                                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
| 150                                                                                                                                                                                            | PARO NO PROGRAMADO         |                                                                                                                                                                                                                                                                                                                     |
| IF(                                                                                                                                                                                            |                            |                                                                                                                                                                                                                                                                                                                     |
|     '1. Paros (OT)'[TIPO_PARO] = ""PROGRAMADO"",                                                                                                                                               |                            |                                                                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
|     SWITCH(                                                                                                                                                                                    |                            |                                                                                                                                                                                                                                                                                                                     |
|         TRUE(),                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
|         // COMIDA: Si dura más de 0.5h, solo el excedente cuenta como no programado                                                                                                            |                            |                                                                                                                                                                                                                                                                                                                     |
|         AND('1. Paros (OT)'[PARO] = ""COMIDA"", '1. Paros (OT)'[DURACION (HR)] > 0.5), '1. Paros (OT)'[DURACION (HR)] - 0.5,                                                                   |                            |                                                                                                                                                                                                                                                                                                                     |
|         // BREAK: Si dura más de 0.17h, solo el excedente cuenta como no programado                                                                                                            |                            |                                                                                                                                                                                                                                                                                                                     |
|         AND('1. Paros (OT)'[PARO] = ""BREAK"", '1. Paros (OT)'[DURACION (HR)] > 0.17), '1. Paros (OT)'[DURACION (HR)] - 0.17,                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
|         // EAD: Si dura más de 1h, solo el excedente cuenta como no programado                                                                                                                 |                            |                                                                                                                                                                                                                                                                                                                     |
|         AND('1. Paros (OT)'[PARO] = ""EAD"", '1. Paros (OT)'[DURACION (HR)] > 1), '1. Paros (OT)'[DURACION (HR)] - 1,                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
|         0 // Si no se excede el límite, todo se queda como programado y no hay no programado                                                                                                   |                            |                                                                                                                                                                                                                                                                                                                     |
|     ),                                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     // Lógica normal para los NO PROGRAMADOS                                                                                                                                                   |                            |                                                                                                                                                                                                                                                                                                                     |
|     SWITCH(                                                                                                                                                                                    |                            |                                                                                                                                                                                                                                                                                                                     |
|         TRUE(),                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
|         AND(                                                                                                                                                                                   |                            |                                                                                                                                                                                                                                                                                                                     |
|             '1. Paros (OT)'[Area] <> ""INYECCION"",                                                                                                                                            |                            |                                                                                                                                                                                                                                                                                                                     |
|             OR(                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
|                 AND('1. Paros (OT)'[PARO] = ""NO PRODUCIDO"", '1. Paros (OT)'[DURACION (HR)] > 5),                                                                                             |                            |                                                                                                                                                                                                                                                                                                                     |
|                 AND('1. Paros (OT)'[PARO] = ""FALTA OT"", '1. Paros (OT)'[DURACION (HR)] > 5)                                                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
|             )                                                                                                                                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
|         ), 0,                                                                                                                                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
|         AND('1. Paros (OT)'[PARO] = ""CAMBIO DE MOLDES"", '1. Paros (OT)'[DURACION (HR)] > 40), '1. Paros (OT)'[DURACION (HR)] - 40,                                                           |                            |                                                                                                                                                                                                                                                                                                                     |
|         AND('1. Paros (OT)'[PARO] = ""CAMBIO MOLDE"", '1. Paros (OT)'[DURACION (HR)] > 40), '1. Paros (OT)'[DURACION (HR)] - 40,                                                               |                            |                                                                                                                                                                                                                                                                                                                     |
|         AND('1. Paros (OT)'[PARO] = ""5´S FIN DE TURNO"", '1. Paros (OT)'[DURACION (HR)] > .17), '1. Paros (OT)'[DURACION (HR)] - .17,                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|         AND('1. Paros (OT)'[PARO] = ""FRECUENCIA"", '1. Paros (OT)'[DURACION (HR)] > 5), '1. Paros (OT)'[DURACION (HR)] - 5,                                                                   |                            |                                                                                                                                                                                                                                                                                                                     |
|         AND('1. Paros (OT)'[PARO] = ""LIBERACIÓN"", '1. Paros (OT)'[DURACION (HR)] > 5), '1. Paros (OT)'[DURACION (HR)] - 5,                                                                   |                            |                                                                                                                                                                                                                                                                                                                     |
|         '1. Paros (OT)'[DURACION (HR)] // Si no hay ninguna condición especial, devuelve la duración sin cambios                                                                               |                            |                                                                                                                                                                                                                                                                                                                     |
|     )                                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| )                                                                                                                                                                                              |                            |                                                                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
| 150                                                                                                                                                                                            | DURACION (Min)             |                                                                                                                                                                                                                                                                                                                     |
| VAR FORMULA = DIVIDE('1. Paros (OT)'[DDuración (SEG)],60)                                                                                                                                      |                            |                                                                                                                                                                                                                                                                                                                     |
| RETURN FORMULA"                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
| 150                                                                                                                                                                                            | VALIDACION_FECHA_FIN       |                                                                                                                                                                                                                                                                                                                     |
| VAR HoraInicio = HOUR('1. Paros (OT)'[INICIO]) + (MINUTE('1. Paros (OT)'[INICIO]) / 60) -- Convierte la hora de INICIO en formato decimal                                                      |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR HoraFin = HOUR('1. Paros (OT)'[FIN]) + (MINUTE('1. Paros (OT)'[FIN]) / 60) -- Convierte la hora de FIN en formato decimal                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR Turno = '1. Paros (OT)'[IDTURNO ACT] -- Obtiene el turno actual                                                                                                                            |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR EsValido =                                                                                                                                                                                 |                            |                                                                                                                                                                                                                                                                                                                     |
|     SWITCH(                                                                                                                                                                                    |                            |                                                                                                                                                                                                                                                                                                                     |
|         TRUE(),                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
|         Turno = ""1"" && HoraFin >= 6 && HoraFin <= 14, 1, -- Turno Día: Inicio >= 6:00 AM y Fin <= 2:00 PM (14:00)                                                                            |                            |                                                                                                                                                                                                                                                                                                                     |
|         Turno = ""2"" && HoraFin >= 14 && HoraFin <= 21.5, 1, -- Turno Tarde: Inicio >= 2:00 PM y Fin <= 9:30 PM (21.5)                                                                        |                            |                                                                                                                                                                                                                                                                                                                     |
|         Turno = ""3"" && (                                                                                                                                                                     |                            |                                                                                                                                                                                                                                                                                                                     |
|             -- Para turno Noche, se valida que la hora de fin esté entre 9:30 PM y 6:00 AM (cruce de AM a PM)                                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
|             (HoraFin >= 21.5 && HoraFin <= 24) || (HoraFin >= 0 && HoraFin <= 6)                                                                                                               |                            |                                                                                                                                                                                                                                                                                                                     |
|         ), 1, -- Turno Noche: Inicio >= 9:30 PM y Fin entre 12:00 AM y 6:00 AM                                                                                                                 |                            |                                                                                                                                                                                                                                                                                                                     |
|         0 -- Si ninguna condición se cumple, marca como 0 (inválido)                                                                                                                           |                            |                                                                                                                                                                                                                                                                                                                     |
|     )                                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| RETURN                                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     EsValido                                                                                                                                                                                   |                            |                                                                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
| 150                                                                                                                                                                                            | DDuración (SEG)            |                                                                                                                                                                                                                                                                                                                     |
| VAR HoraInicio = '1. Paros (OT)'[INICIO]                                                                                                                                                       |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR HoraFinOriginal = '1. Paros (OT)'[FIN]                                                                                                                                                     |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR Turno = '1. Paros (OT)'[IDTURNO ACT]                                                                                                                                                       |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR Validacion = '1. Paros (OT)'[VALIDACION_FECHA_FIN]                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
| -- Determinar el límite de hora del turno                                                                                                                                                      |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR LimiteHoraFin =                                                                                                                                                                            |                            |                                                                                                                                                                                                                                                                                                                     |
|     SWITCH(                                                                                                                                                                                    |                            |                                                                                                                                                                                                                                                                                                                     |
|         TRUE(),                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
|         Turno = ""1"", DATE(YEAR(HoraInicio), MONTH(HoraInicio), DAY(HoraInicio)) + TIME(14, 0, 0), -- Turno Día: 2:00 PM                                                                      |                            |                                                                                                                                                                                                                                                                                                                     |
|         Turno = ""2"", DATE(YEAR(HoraInicio), MONTH(HoraInicio), DAY(HoraInicio)) + TIME(21, 30, 0), -- Turno Tarde: 9:30 PM                                                                   |                            |                                                                                                                                                                                                                                                                                                                     |
|         Turno = ""3"", DATE(YEAR(HoraInicio), MONTH(HoraInicio), DAY(HoraInicio) + (IF(HoraInicio > TIME(6, 0, 0), 0, 1))) + TIME(6, 0, 0) -- Turno Noche: 6:00 AM, considerando cambio de día |                            |                                                                                                                                                                                                                                                                                                                     |
|     )                                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| -- Ajustar la hora de fin si VALIDACION_FECHA_FIN es 0                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR HoraFinAjustada =                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
|     IF(                                                                                                                                                                                        |                            |                                                                                                                                                                                                                                                                                                                     |
|         Validacion = 0,                                                                                                                                                                        |                            |                                                                                                                                                                                                                                                                                                                     |
|         MIN(LimiteHoraFin, HoraFinOriginal), -- Usar la menor entre el límite del turno y la hora fin original                                                                                 |                            |                                                                                                                                                                                                                                                                                                                     |
|         HoraFinOriginal -- Usar la hora fin original si la validación es 1                                                                                                                     |                            |                                                                                                                                                                                                                                                                                                                     |
|     )                                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| -- Ajustar la hora de fin en caso de cruce de día                                                                                                                                              |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR HoraFinFinal =                                                                                                                                                                             |                            |                                                                                                                                                                                                                                                                                                                     |
|     IF(                                                                                                                                                                                        |                            |                                                                                                                                                                                                                                                                                                                     |
|         HoraFinAjustada < HoraInicio,                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
|         HoraFinAjustada + 1,  -- Si HoraFin es antes de HoraInicio, sumar un día completo (24 horas)                                                                                           |                            |                                                                                                                                                                                                                                                                                                                     |
|         HoraFinAjustada       -- Si no, usar la hora ajustada                                                                                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
|     )                                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| -- Calcular la diferencia en segundos                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR DuracionSegundos =                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     DATEDIFF(HoraInicio, HoraFinFinal, SECOND) -- Diferencia en segundos, siempre positiva                                                                                                     |                            |                                                                                                                                                                                                                                                                                                                     |
| RETURN                                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     DuracionSegundos                                                                                                                                                                           |                            |                                                                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
| 150                                                                                                                                                                                            | ACTIVAR                    |                                                                                                                                                                                                                                                                                                                     |
| IF(                                                                                                                                                                                            |                            |                                                                                                                                                                                                                                                                                                                     |
|     '1. Paros (OT)'[DDuración (SEG)] < 0 ||                                                                                                                                                    |                            |                                                                                                                                                                                                                                                                                                                     |
|     (WEEKDAY('1. Paros (OT)'[FECHA], 2) = 1 && '1. Paros (OT)'[IDTURNO ACT] = ""3"") ||                                                                                                        |                            |                                                                                                                                                                                                                                                                                                                     |
|     ('1. Paros (OT)'[IDTURNO ACT] = ""1"" && '1. Paros (OT)'[DURACION (HR)] > 8) ||                                                                                                            |                            |                                                                                                                                                                                                                                                                                                                     |
|     ('1. Paros (OT)'[IDTURNO ACT] = ""2"" && '1. Paros (OT)'[DURACION (HR)] > 7.5) ||                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
|     ('1. Paros (OT)'[IDTURNO ACT] = ""3"" && '1. Paros (OT)'[DURACION (HR)] > 8.5) ||                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
|     (WEEKDAY('1. Paros (OT)'[FECHA], 2) = 7 && '1. Paros (OT)'[PARO] = ""No Producido"") ||                                                                                                    |                            |                                                                                                                                                                                                                                                                                                                     |
|     (WEEKDAY('1. Paros (OT)'[FECHA], 2) = 1 && '1. Paros (OT)'[IDTURNO ACT] = ""3"" && '1. Paros (OT)'[PARO] = ""No Producido"") ||                                                            |                            |                                                                                                                                                                                                                                                                                                                     |
|     '1. Paros (OT)'[PARO]="""",                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
|     0,                                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     1                                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| )"                                                                                                                                                                                             |                            |                                                                                                                                                                                                                                                                                                                     |
| 21891                                                                                                                                                                                          | Activa                     |                                                                                                                                                                                                                                                                                                                     |
| IF(                                                                                                                                                                                            |                            |                                                                                                                                                                                                                                                                                                                     |
|     '0. Catalogo Lineas'[Linea] IN {                                                                                                                                                           |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""L-03"", ""L-PLOMER 3"", ""L-07"", ""L-PAQ-1"", ""I-M29"", ""L-15"",                                                                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""L-PLOMER 8"", ""I-M08"", ""I-M01"", ""L-PLOMER11"", ""L-PLOMER10"",                                                                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""L-PLOMER 1"", ""L-12"", ""L-ROTARY2"", ""L-08"", ""L-20"", ""L-PLOMER 7"",                                                                                                           |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""L-GRABADO"", ""L-PLOMER 5"", ""L-13"", ""I-M26"", ""L-05"", ""I-M21"",                                                                                                               |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""I-M02"", ""L-PLOMER 9"", ""I-M23"", ""L-21"", ""I-M20"", ""L-14"", ""L-19"",                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""L-PAQ-2"", ""L-06"", ""L-01"", ""I-M34"", ""L-PLOMER 6"", ""I-M27"",                                                                                                                 |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""L-PLOMER 4"", ""I-M09"", ""I-M33"", ""I-M16"", ""I-M11"", ""I-M28"",                                                                                                                 |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""I-M25"", ""I-M10"", ""I-M07"", ""I-M18"", ""L-GAS"", ""I-M12"", ""I-M05"",                                                                                                           |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""L-09"", ""I-M35"", ""I-M32"", ""L-PAQ-4"", ""L-11"", ""L-PLOMER 2"",                                                                                                                 |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""I-M24"", ""L-MULTICAP"", ""L-PAQ-3"", ""I-M30"", ""L-TRAMPAS"", ""I-M13"",                                                                                                           |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""L-10"", ""I-M03"", ""I-M04"", ""I-M19"", ""L-HERRAJE2"", ""I-M15"",                                                                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""L-ROTARY"", ""I-M06"", ""L-HERRAJES"", ""I-M14"", ""I-M31"", ""I-M22"",                                                                                                              |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""I-M17"", ""I-EX1""                                                                                                                                                                   |                            |                                                                                                                                                                                                                                                                                                                     |
|     },                                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     1,                                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     0                                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| )                                                                                                                                                                                              |                            |                                                                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
| 22002                                                                                                                                                                                          | Tiempo Hr                  |                                                                                                                                                                                                                                                                                                                     |
| SWITCH(                                                                                                                                                                                        |                            |                                                                                                                                                                                                                                                                                                                     |
|     '0. Catalogo Turnos'[IDTURNO ACT],                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     ""1"", 8,                                                                                                                                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
|     ""2"", 7.5,                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
|     ""3"", 8.5,                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
|     BLANK()  // En caso de que no coincida con ninguno                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
| )"                                                                                                                                                                                             |                            |                                                                                                                                                                                                                                                                                                                     |
| 479451                                                                                                                                                                                         | Activa                     |                                                                                                                                                                                                                                                                                                                     |
| IF(                                                                                                                                                                                            |                            |                                                                                                                                                                                                                                                                                                                     |
|     '0. Catalogo Lineas Final'[Linea] IN {                                                                                                                                                     |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""L-03"", ""L-PLOMER 3"", ""L-07"", ""L-PAQ-1"", ""I-M29"", ""L-15"",                                                                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""L-PLOMER 8"", ""I-M08"", ""I-M01"", ""L-PLOMER11"", ""L-PLOMER10"",                                                                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""L-PLOMER 1"", ""L-12"", ""L-ROTARY2"", ""L-08"", ""L-20"", ""L-PLOMER 7"",                                                                                                           |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""L-GRABADO"", ""L-PLOMER 5"", ""L-13"", ""I-M26"", ""L-05"", ""I-M21"",                                                                                                               |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""I-M02"", ""L-PLOMER 9"", ""I-M23"", ""L-21"", ""I-M20"", ""L-14"", ""L-19"",                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""L-PAQ-2"", ""L-06"", ""L-01"", ""I-M34"", ""L-PLOMER 6"", ""I-M27"",                                                                                                                 |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""L-PLOMER 4"", ""I-M09"", ""I-M33"", ""I-M16"", ""I-M11"", ""I-M28"",                                                                                                                 |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""I-M25"", ""I-M10"", ""I-M07"", ""I-M18"", ""L-GAS"", ""I-M12"", ""I-M05"",                                                                                                           |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""L-09"", ""I-M35"", ""I-M32"", ""L-PAQ-4"", ""L-11"", ""L-PLOMER 2"",                                                                                                                 |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""I-M24"", ""L-MULTICAP"", ""L-PAQ-3"", ""I-M30"", ""L-TRAMPAS"", ""I-M13"",                                                                                                           |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""L-10"", ""I-M03"", ""I-M04"", ""I-M19"", ""L-HERRAJE2"", ""I-M15"",                                                                                                                  |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""L-ROTARY"", ""I-M06"", ""L-HERRAJES"", ""I-M14"", ""I-M31"", ""I-M22"",                                                                                                              |                            |                                                                                                                                                                                                                                                                                                                     |
|         ""I-M17"", ""I-EX1""                                                                                                                                                                   |                            |                                                                                                                                                                                                                                                                                                                     |
|     },                                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     1,                                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     0                                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| )                                                                                                                                                                                              |                            |                                                                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
| 3329051                                                                                                                                                                                        | Validación_Faltantes       |                                                                                                                                                                                                                                                                                                                     |
| VAR Cantidad_Faltantes = '1. Faltantes (OT)'[CANTIDAD]                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
| VAR Cantidad_Produccion =                                                                                                                                                                      |                            |                                                                                                                                                                                                                                                                                                                     |
|     LOOKUPVALUE(                                                                                                                                                                               |                            |                                                                                                                                                                                                                                                                                                                     |
|         '1. Producción (OT)'[Cantidad UN],                                                                                                                                                     |                            |                                                                                                                                                                                                                                                                                                                     |
|         '1. Producción (OT)'[SECUENCIA],                                                                                                                                                       |                            |                                                                                                                                                                                                                                                                                                                     |
|         '1. Faltantes (OT)'[SECUENCIA]                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
|     )                                                                                                                                                                                          |                            |                                                                                                                                                                                                                                                                                                                     |
| RETURN                                                                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
| IF(ISBLANK(Cantidad_Produccion), BLANK(),                                                                                                                                                      |                            |                                                                                                                                                                                                                                                                                                                     |
|     IF(Cantidad_Faltantes > Cantidad_Produccion, 0, 1)                                                                                                                                         |                            |                                                                                                                                                                                                                                                                                                                     |
| )                                                                                                                                                                                              |                            |                                                                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                |                            |                                                                                                                                                                                                                                                                                                                     |
